function uptoken(e,n){var i=new qiniu.rs.PutPolicy(e+":"+n);return i.token()}function uploadFile(e,n,i){var t=new qiniu.io.PutExtra;qiniu.io.putFile(e,n,i,t,function(e,n){e?console.log(e):console.log("upload success : ",n.hash,n.key)})}function getFilenameSuffix(e){if(".DS_Store"==e)return".DS_Store";if(null==e||0==e.length)return null;var n=/\.[^\.]+/.exec(e);return null==n?null:(n+"").toLowerCase()}const fs=require("fs"),path="../../photos";var qiniu=require("qiniu");qiniu.conf.ACCESS_KEY="zeDw8a27RIDTr9PLkYZeqDZuB0Ruw4WqJ5uiAsz8",qiniu.conf.SECRET_KEY="WpqSk-iE5gVh_nwxrEzJW0EGqY2n9r67774KXRwH",bucket="hexo",fs.readdir(path,function(e,n){if(!e){var i=[];!function t(e){return e==n.length?void fs.writeFile("./output.json",JSON.stringify(i,null,"	")):void fs.stat(path+"/"+n[e],function(u,o){if(!u){if(o.isFile()){var r=getFilenameSuffix(n[e]);".js"!=r&&".DS_Store"!=r&&(filePath=path+"/"+n[e],console.log("抓取到文件: "+n[e]),key=n[e],token=uptoken(bucket,key),uploadFile(token,key,filePath),i.push(n[e]))}t(e+1)}})}(0)}});